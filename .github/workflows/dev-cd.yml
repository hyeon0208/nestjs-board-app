name: Deploy Application

on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'Select deployment environment'
        required: true
        default: 'dev'
        type: choice
        options:
        - dev
        - prod
      prod_confirmation:
        description: 'I understand this will deploy to PRODUCTION'
        required: false
        default: false
        type: boolean

jobs:
  validate:
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
    - name: Validate production deployment
      if: ${{ github.event.inputs.environment == 'prod' }}
      run: |
        if [ "${{ github.event.inputs.prod_confirmation }}" != "true" ]; then
          echo "❌ Production deployment requires confirmation checkbox"
          exit 1
        fi
        echo "✅ Production deployment confirmed"