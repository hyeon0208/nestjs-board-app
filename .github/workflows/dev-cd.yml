name: Deploy Application

on:
  workflow_dispatch:
    inputs:
      target_environment:
        description: '배포 환경 선택'
        required: true
        type: environment

jobs:
  deploy:
    name: 환경별 배포
    runs-on: ubuntu-latest
    environment: ${{ inputs.target_environment }}
    steps:
    - name: 환경 정보 출력
      run: |
        echo "🚀 배포 환경: ${{ inputs.target_environment }}"
        
    - name: Environment Secrets 확인
      run: |
        echo "=== Environment Secrets 확인 ==="
        if [ -n "${{ secrets.DATABASE_URL }}" ]; then
          echo "✅ DATABASE_URL: 설정됨"
        else
          echo "❌ DATABASE_URL: 설정되지 않음"
        fi
        
        if [ -n "${{ secrets.API_KEY }}" ]; then
          echo "✅ API_KEY: 설정됨"
        else
          echo "❌ API_KEY: 설정되지 않음"
        fi
        
    - name: Environment Variables 확인  
      run: |
        echo "=== Environment Variables 확인 ==="
        echo "LOG_LEVEL: ${{ vars.LOG_LEVEL }}"
        echo "PORT: ${{ vars.PORT }}"
        
    - name: 환경별 배포
      run: |
        echo "=== ${{ inputs.target_environment }} 환경 배포 시작 ==="
        # inputs.target_environment 직접 사용!