name: Deploy Application

on:
  workflow_dispatch:
    inputs:
      environment:
        description: '배포 환경을 선택하세요'
        required: true
        default: 'dev'
        type: choice
        options:
        - dev
        - prod
      prod_confirmation:
        description: '☑️ 프로덕션 환경에 배포하는 것을 이해했습니다'
        required: false
        default: false
        type: boolean

jobs:
  validate:
    name: 배포 유효성 검사
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
    - name: 브랜치 확인
      run: echo "✅ main 브랜치에서 실행 중입니다"
    
    - name: 프로덕션 배포 확인
      if: ${{ github.event.inputs.environment == 'prod' }}
      run: |
        if [ "${{ github.event.inputs.prod_confirmation }}" != "true" ]; then
          echo "❌ 프로덕션 배포를 위해서는 확인 체크박스를 선택해야 합니다"
          echo "⚠️  프로덕션 환경 배포는 신중히 진행해주세요"
          exit 1
        fi
        echo "✅ 프로덕션 배포가 확인되었습니다"ㅍㅍ