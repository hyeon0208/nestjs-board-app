name: Deploy Application

on:
  workflow_dispatch:
    inputs:
      target_environment:
        description: '배포 환경 선택'
        required: true
        type: environment
      # prod_confirmation 필드 제거 - Environment 보호 규칙으로 대체

jobs:
  deploy:
    name: 환경별 배포
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    environment: ${{ inputs.target_environment }}  # 선택된 환경 직접 적용
    steps:
    - name: 환경 정보 출력
      run: |
        echo "🚀 배포 환경: ${{ inputs.target_environment }}"
        echo "📍 현재 브랜치: ${{ github.ref_name }}"
        
    - name: 환경별 배포 로직
      run: |
        case "${{ inputs.target_environment }}" in
          "development"|"dev")
            echo "🔧 개발환경 배포를 시작합니다"
            # 개발환경 배포 스크립트
            ;;
          "production"|"prod")
            echo "⚠️  운영환경 배포를 시작합니다"
            # 운영환경 배포 스크립트
            ;;
          *)
            echo "📦 ${{ inputs.target_environment }} 환경에 배포합니다"
            # 기타 환경 배포 스크립트
            ;;
        esac